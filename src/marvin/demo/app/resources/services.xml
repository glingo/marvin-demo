<?xml version="1.0" encoding="UTF-8"?>
<container>
    <parameters>
        <!--<parameter id="test.parameter.string" type="java.lang.String" value="My parameter string"/>-->

    </parameters>
    
    <!--<import resource="config/imported_config.xml" />-->
    
    <services>
        
        <!-- ROUTING -->
        <!-- Router subscriber definition -->
        <service id="router.subscriber" class="com.marvin.web.routing.event.RouterSubscriber">
            <argument type="service" ref="router"/>
            <tag name="event_subscriber"/>
        </service>
        
        <service id="argument_resolver" class="com.marvin.web.controller.HttpServletRequestArgumentResolver" /> 
        
        <service id="controller.resolver" class="com.marvin.web.controller.HttpServletRequestControllerResolver">
            <argument type="service" ref="controller.name_parser"/>
        </service>
        
        <service id="request_handler" class="com.marvin.web.RequestHandler">
            <argument type="service" ref="event_dispatcher"/>
            <argument type="service" ref="controller.resolver"/>
            <argument type="service" ref="argument_resolver"/>
        </service>
        
        <!--<service id="request_uri_matcher" class="com.marvin.web.routing.matcher.UriMatcher" />-->
        <service id="path_matcher" class="com.marvin.component.routing.matcher.PathMatcher" />

        <service id="request_matcher" class="com.marvin.component.routing.matcher.MatcherDelegate">
            <argument>
                <list>
                    <!--<argument type="service" ref="request_uri_matcher"/>-->
                    <argument type="service" ref="path_matcher"/>
                </list>
            </argument>
        </service>
        
        <!-- Router definition -->
        <service id="router" class="com.marvin.component.routing.Router">
            <argument type="service" ref="router.reader_xml" />
            <argument type="parameter" ref="router.resource" />
            <argument type="service" ref="request_matcher" />
        </service>
        
        <!-- Give a test service named Service A to the container -->
<!--        <service id="test.service.a" class="com.marvin.service.TestServiceA">
            <argument type="java.lang.String" value="test.service.a"/>
            <argument type="int" value="1"/>
        </service>-->
        
        <!-- Give a test service named Service B ( with a reference to Service A ) to the container -->
<!--        <service id="test.service.b" class="app.service.TestServiceB">
            <argument type="service" ref="test.service.a"/>
            <argument type="java.lang.String" value="Service B"/>
            <argument type="int" value="2"/>
        </service>-->
        
<!--        <service id="test.service.a.with.call" class="com.marvin.service.TestServiceA">
            <argument type="java.lang.String" value="test.service.a.with.call"/>
            <argument type="int" value="1"/>
            <call name="say">
                <argument type="java.lang.String" value="Service A"/>
                <argument type="int" value="1"/>
            </call>
            <call name="callService">
                <argument type="service" ref="test.service.a"/>
            </call>
        </service>-->
 
    </services>
</container>
